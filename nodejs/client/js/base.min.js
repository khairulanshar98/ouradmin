angular.module("ngProgress.provider",["ngProgress.directive"]).service("ngProgress",function(){return["$document","$window","$compile","$rootScope","$timeout",function(a,e,c,d,g){this.autoStyle=!0;this.count=0;this.height="2px";this.$scope=d.$new();this.color="firebrick";this.parent=a.find("body")[0];this.count=0;this.progressbarEl=c("<ng-progress></ng-progress>")(this.$scope);this.parent.appendChild(this.progressbarEl[0]);this.$scope.count=this.count;void 0!==this.height&&this.progressbarEl.eq(0).children().css("height",
this.height);void 0!==this.color&&(this.progressbarEl.eq(0).children().css("background-color",this.color),this.progressbarEl.eq(0).children().css("color",this.color));this.intervalCounterId=0;this.start=function(){this.show();var a=this;clearInterval(this.intervalCounterId);this.intervalCounterId=setInterval(function(){isNaN(a.count)?(clearInterval(a.intervalCounterId),a.count=0,a.hide()):(a.remaining=100-a.count,a.count+=0.15*Math.pow(1-Math.sqrt(a.remaining),2),a.updateCount(a.count))},200)};this.updateCount=
function(a){this.$scope.count=a;this.$scope.$$phase||this.$scope.$apply()};this.setHeight=function(a){void 0!==a&&(this.height=a,this.$scope.height=this.height,this.$scope.$$phase||this.$scope.$apply());return this.height};this.setColor=function(a){void 0!==a&&(this.color=a,this.$scope.color=this.color,this.$scope.$$phase||this.$scope.$apply());return this.color};this.hide=function(){this.progressbarEl.children().css("opacity","0");var a=this;a.animate(function(){a.progressbarEl.children().css("width",
"0%");a.animate(function(){a.show()},500)},500)};this.show=function(){var a=this;a.animate(function(){a.progressbarEl.children().css("opacity","1")},100)};this.animate=function(a,f){void 0!==this.animation&&g.cancel(this.animation);this.animation=g(a,f)};this.status=function(){return this.count};this.stop=function(){clearInterval(this.intervalCounterId)};this.set=function(a){this.show();this.updateCount(a);this.count=a;clearInterval(this.intervalCounterId);return this.count};this.css=function(a){return this.progressbarEl.children().css(a)};
this.reset=function(){clearInterval(this.intervalCounterId);this.count=0;this.updateCount(this.count);return 0};this.complete=function(){this.count=100;this.updateCount(this.count);var a=this;clearInterval(this.intervalCounterId);g(function(){a.hide();g(function(){a.count=0;a.updateCount(a.count)},500)},1E3);return this.count};this.setParent=function(a){if(null===a||void 0===a)throw Error("Provide a valid parent of type HTMLElement");null!==this.parent&&void 0!==this.parent&&this.parent.removeChild(this.progressbarEl[0]);
this.parent=a;this.parent.appendChild(this.progressbarEl[0])};this.getDomElement=function(){return this.progressbarEl};this.setAbsolute=function(){this.progressbarEl.css("position","absolute")}}]}).factory("ngProgressFactory",["$injector","ngProgress",function(a,e){return{createInstance:function(){return a.instantiate(e)}}}]);
angular.module("ngProgress.directive",[]).directive("ngProgress",["$window","$rootScope",function(a,e){return{replace:!0,restrict:"E",link:function(a,d,e,b){a.$watch("count",function(f){if(void 0!==f||null!==f)a.counter=f,d.eq(0).children().css("width",f+"%")});a.$watch("color",function(f){if(void 0!==f||null!==f)a.color=f,d.eq(0).children().css("background-color",f),d.eq(0).children().css("color",f)});a.$watch("height",function(f){if(void 0!==f||null!==f)a.height=f,d.eq(0).children().css("height",
f)})},template:'<div id="ngProgress-container"><div id="ngProgress"></div></div>'}}]);angular.module("ngProgress",["ngProgress.directive","ngProgress.provider"]);var app=angular.module("ouradmin",["ngRoute","ngResource","ngProgress","Ctrlmodule","rootController"]).constant("AUTH_EVENTS",{notAuthenticated:"auth-not-authenticated",wrongPassword:"wrong-password",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{admin:"admin_role","public":"public_role"}).config(["$routeProvider","$controllerProvider",function(a,e){app.controller=e.register;a.when("/:name",{templateUrl:function(a){return"views/partials/"+a.name+".html"}}).when("/:name/:arg1",{templateUrl:function(a){return"views/partials/"+
a.name+".html"}}).when("/:name/:arg1/:arg2",{templateUrl:function(a){return"views/partials/"+a.name+".html"}}).when("/:name/:arg1/:arg2/:arg3",{templateUrl:function(a){return"views/partials/"+a.name+".html"}}).when("/:name/:arg1/:arg2/:arg3/:arg4",{templateUrl:function(a){return"views/partials/"+a.name+".html"}}).when("/:name/:arg1/:arg2/:arg3/:arg4/:arg5",{templateUrl:function(a){return"views/partials/"+a.name+".html"}}).when("/:name/:arg1/:arg2/:arg3/:arg4/:arg5/:arg6",{templateUrl:function(a){return"views/partials/"+
a.name+".html"}}).when("/",{templateUrl:"/views/partials/root.html"}).otherwise({redirectTo:"/main"})}]).run(["$rootScope","$location","ngProgressFactory",function(a,e,c){a.progressbar=c.createInstance();a.progressbar.setHeight("4");a.progressbar.setColor("#066dab");a.$on("$routeChangeStart",function(d,c,b){a.progressbar.start();b&&(c&&c.params)&&(c.$$route.controller=c.params.name,a.progressbar.complete())})}]);angular.module("ouradmin").service("AuthService",["$q","$http","USER_ROLES",function(a,e,c){function d(a){g=a.split("#")[0];b=!0;a.split("#");e.defaults.headers.common["X-Auth-Token"]=a.split("#")[1]}var g="",b=!1;(function(){var a=window.localStorage.getItem("yourTokenKey");a&&d(a)})();return{login:function(f){return a(function(a,b){e.post("/user/authenticate",f).then(function(b){var c=f.email+"#"+b.data.token;window.localStorage.setItem("yourTokenKey",c);d(c);a(b)},function(a){b(a.data.msg)})})},
signup:function(b){return a(function(a,c){0<b.email.length&&0<b.passwd.length&&0<b.passwdRepeat.length?b.passwd!==b.passwdRepeat?c("Please check your password and repreat password"):e.post("/user/register",b).then(function(c){var e=b.email+"#"+c.data.token;window.localStorage.setItem("yourTokenKey",e);d(e);a(c)},function(a){console.log(a);c(a.data.msg)}):c("Please Enter your email, password and repreat password")})},logout:function(){g="";b=!1;e.defaults.headers.common["X-Auth-Token"]=void 0;window.localStorage.removeItem("yourTokenKey")},
isAuthorized:function(a){angular.isArray(a)||(a=[a]);return b&&-1!==a.indexOf("")},isAuthenticated:function(){return b},getEmail:function(){return g},getRole:function(){return""}}}]).factory("AuthInterceptor",["$rootScope","$q","AUTH_EVENTS",function(a,e,c){return{responseError:function(d){a.$broadcast({401:c.notAuthenticated,402:c.wrongPassword,403:c.notAuthorized}[d.status],d);return e.reject(d)}}}]).config(["$httpProvider",function(a){a.interceptors.push("AuthInterceptor")}]);angular.module("Ctrlmodule",[]).factory("Ctrlmodule",function(){return{init:function(a,e,c,d,g){a.progressbar=g.createInstance();a.progressbar.setHeight("4");a.progressbar.setColor("red");a.progressbar.start();a.records=[];a.initial=[];a.itemmodel=d.copy(a.defaultmodel);a.Model=e(a.api_attribute);a.Model.query(function(b){a.records=b;a.progressbar.complete()});a.save=function(b){a.progressbar.start();b.isedit=!1;var c=new a.Model;c.name=b.name;"Unit Price"===a.name_attribute&&(c.unit_price=b.unit_price);
c[a.id_attribute]=b[a.id_attribute];c.$save(function(b){a.progressbar.complete()})};a.createnew=function(){a.progressbar.start();var b=new a.Model,c;for(c in a.itemmodel)a.itemmodel.hasOwnProperty(c)&&(b[c]=a.itemmodel[c]);b.name=a.itemmodel.value;"Unit Price"===a.name_attribute&&(b.unit_price=a.itemmodel.value);b[a.id_attribute]="";b.$save(function(b){b.success&&a.records.push(b.record);a.itemmodel=d.copy(a.defaultmodel);a.catgory.model={};a.product.model={};a.size.model={};a.hotcold.model={};a.progressbar.complete()})};
a.setInit=function(a){a.isedit=!1;a.initial={};a.initial=d.copy(a)};a.edit=function(a){a.isedit=!0};a.cancel=function(b){var c=b[a.id_attribute],e=d.copy(b.initial.name);d.forEach(a.records,function(b,d){b[a.id_attribute]===c&&(b.name=e,b.isedit=!1)},[])};a.catgory={};a.catgory.model={};a.catgory.availableOptions=[];"Product Name"===a.name_attribute&&(a.changeCatgory=function(){a.itemmodel.cat_id=a.catgory.model.cat_id;a.itemmodel.cat_name=a.catgory.model.name},c=e("/category/api"),a.progressbar.start(),
c.query(function(b){a.catgory.availableOptions=b;a.progressbar.complete()}));a.size={};a.size.model={};a.size.availableOptions=[];"Unit Price"===a.name_attribute&&(a.changeSize=function(){a.itemmodel.size_id=a.size.model.size_id;a.itemmodel.size_name=a.size.model.name},c=e("/size/api"),a.progressbar.start(),c.query(function(b){a.size.availableOptions=b;a.progressbar.complete()}));a.product={};a.product.model={};a.product.availableOptions=[];"Unit Price"===a.name_attribute&&(a.changeProduct=function(){a.itemmodel.item_id=
a.product.model.item_id;a.itemmodel.item_name=a.product.model.name;a.itemmodel.cat_id=a.product.model.cat_id;a.itemmodel.cat_name=a.product.model.cat_name},e=e("/product/api"),a.progressbar.start(),e.query(function(b){a.product.availableOptions=b;a.progressbar.complete()}));a.hotcold={};a.hotcold.model={};a.hotcold.availableOptions=[{name:"Hot"},{name:"Cold"}];"Unit Price"===a.name_attribute&&(a.changeHotCold=function(){a.itemmodel.hot_cold=a.hotcold.model.name})}}});angular.module("rootController",[]).controller("rootController",["$scope","$resource","$location","$timeout","ngProgressFactory","AuthService","AUTH_EVENTS",function(a,e,c,d,g,b,f){a.user={email:"",passwd:"",passwdRepeat:""};a.basePath=c.$$path;a.objectDisabled=!1;a.isAuthenticated=b.isAuthenticated();c.path("/");a.isAuthenticated?0<=a.basePath.indexOf("/login/")?d(function(){c.path(a.basePath)},1E3):d(function(){c.path("/main")},1E3):d(function(){c.path("/login/login")},1E3);a.user.email=b.getEmail();
a.$on(f.notAuthorized,function(a){alert("You are not allowed to access this resource.")});a.$on(f.wrongPassword,function(a){b.logout();d(function(){c.path("/login/login")},1E3)});a.$on(f.notAuthenticated,function(a){b.logout();alert("Session Lost!\nSorry, You have to login again.");d(function(){c.path("/main")},1E3)});a.setCurrentEmail=function(b){a.user.email=b};a.logout=function(){b.logout();a.isAuthenticated=b.isAuthenticated();c.path("/login/login")};a.login=function(d){a.objectDisabled=!0;b.login(d).then(function(e){a.setCurrentEmail(d.email);
a.isAuthenticated=b.isAuthenticated();a.objectDisabled=!1;c.path("/main")},function(b){alert(b);a.objectDisabled=!1})};a.signup=function(d){a.objectDisabled=!0;b.signup(d).then(function(d){a.objectDisabled=!1;a.isAuthenticated=b.isAuthenticated();c.path("/main")},function(b){alert(b);a.objectDisabled=!1})}}]);
